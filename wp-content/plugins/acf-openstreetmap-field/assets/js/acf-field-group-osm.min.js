!function(s,n){var t=window.osm,e=t.Field;t.Field=e.extend({$lat:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-center_lat"]')},$lng:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-center_lng"]')},$zoom:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-zoom"]')},$returnFormat:function(){return this.$el.closest(".acf-field-settings").find('[data-name="return_format"]')},getMapData:function(){return{lat:parseFloat(this.$lat().val()||this.$el.data().mapLat),lng:parseFloat(this.$lng().val()||this.$el.data().mapLng),zoom:parseInt(this.$zoom().val()||this.$el.data().mapZoom),layers:this.$el.data().mapLayers}},initialize:function(t){e.prototype.initialize.apply(this,[t]),this.bindMapListener(),this.bindListener()},updateInput:function(){this.$lat().val(this.model.get("lat")).trigger("change"),this.$lng().val(this.model.get("lng")).trigger("change"),this.$zoom().val(this.model.get("zoom")).trigger("change")},initLayers:function(){this.model.get("layers");this.config.restrict_providers="osm"===this.$returnFormat().find(":checked").val()?Object.values(n.options.osm_layers):Object.values(n.options.leaflet_layers),e.prototype.initLayers.apply(this,arguments);var t=s(this.layersControl.getContainer()).find('[type="radio"],[type="checkbox"]'),i=this.$zoom().attr("name").replace("[zoom]","[layers][]");return t.each(function(t,n){var e=s(n);s(n).attr("name",i).attr("value",e.next().text().trim())}),this},bindInputListener:function(){var n=this;this.$lat().on("change",function(t){n.model.set("lat",s(t.target).val()),n.update_map()}).on("focus",function(t){n.unbindMapListener()}).on("blur",function(t){n.bindMapListener()}),this.$lng().on("change",function(t){n.model.set("lng",s(t.target).val()),n.update_map()}).on("focus",function(t){n.unbindMapListener()}).on("blur",function(t){n.bindMapListener()}),this.$zoom().on("change",function(t){n.model.set("zoom",s(t.target).val()),n.update_map()}).on("focus",function(t){n.unbindMapListener()}).on("blur",function(t){n.bindMapListener()})},bindMapListener:function(){this.listenTo(this.model,"change:lat",this.updateInput),this.listenTo(this.model,"change:lng",this.updateInput),this.listenTo(this.model,"change:zoom",this.updateInput)},bindListener:function(){var e=this;this.$returnFormat().on("change",function(t){var n=e.model.get("layers");e.resetLayers(),e.model.set("layers",n),e.initLayers()})},unbindInputListener:function(){this.$lat().off("change").off("focus").off("blur"),this.$lng().off("change").off("focus").off("blur"),this.$zoom().off("change").off("focus").off("blur")},unbindMapListener:function(){this.stopListening(this.model,"change:lat",this.updateInput),this.stopListening(this.model,"change:lng",this.updateInput),this.stopListening(this.model,"change:zoom",this.updateInput)},update_visible:function(){var t=this.visible;e.prototype.update_visible.apply(this,arguments),t!==this.visible&&(this.visible?this.bindInputListener():this.unbindInputListener())}})}(jQuery,acf_osm_admin);